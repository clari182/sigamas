<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../Templates/topHeaderTemplate.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="content">

        <h:form id="form">   
            <p:breadCrumb id="mainBreadCrumb">
                <p:menuitem value="Home" outcome="homeClient"/>              
                <p:menuitem value="Usuarios" outcome="usuariosCuenta"/>                                 
            </p:breadCrumb>
            <p:menubar>                
                <p:menuitem value="Invitar Nuevo Usuario" icon="ui-icon-contact" outcome="invitacionUsuario"/>                    
            </p:menubar>
            <div style="height: 10px; clear: both;"/>
            <p:panel header="Usuarios" style="width:55%; float: left;">
                <p:dataTable id="tabla-usuarios" 
                             var="usuario" 
                             value="#{beanSesionUsuario.cuentaActual.usuarioList}" 
                             selectionMode="single"
                             selection="#{beanUsuario.usuario}"    
                             rowKey="#{usuario.idUsuario}">
                    <p:column headerText="Nombre de usuario">
                        <h:outputText value="#{usuario.nombreUsuario}" />
                    </p:column>

                    <p:column headerText="Nombre">
                        <h:outputText value="#{usuario.nombre}" />
                    </p:column>

                    <p:column headerText="Apellido">
                        <h:outputText value="#{usuario.apellidos}" />
                    </p:column>

                    <p:column headerText="Mail">
                        <h:outputText value="#{usuario.emailUsuario}" />
                    </p:column>                
                </p:dataTable>         
            </p:panel>            
            <p:accordionPanel  style="width:40%; float: right;">
                <p:tab title="Invitaciones de usuario pendientes">
                    TODO : Lista con las invitaciones pendientes
                </p:tab>
                <p:tab title="Ãšltimos accesos">
                    TODO : Lista con los ultimos accesos de usuarios a la cuenta
                </p:tab>
                <p:tab title="Informes">
                    TODO : Lista con informes de uso de la cuenta
                </p:tab>
            </p:accordionPanel>
            <div style="clear:both;"/>
            <p:contextMenu for="tabla-usuarios">
                <p:menuitem value="Ver" update="detailUsuario" icon="ui-icon-search" oncomplete="PF('dialogUsuario').show()"/>
                <p:menuitem value="Borrar" icon="ui-icon-close"/>
            </p:contextMenu>

            <p:dialog header="Informacion de Usuario" widgetVar="dialogUsuario" modal="true" showEffect="fade" hideEffect="fade" resizable="false" height="100%">
                <p:outputPanel id="detailUsuario" style="text-align:center;">
                    <p:panelGrid  columns="2" rendered="#{not empty beanUsuario.usuario}" columnClasses="label,value">                       

                        <h:outputText value="Nombre de usuario"/>
                        <h:outputText value="#{beanUsuario.usuario.nombreUsuario}" />

                        <h:outputText value="Nombre"/>
                        <h:outputText value="#{beanUsuario.usuario.nombre}" />

                        <h:outputText value="Apellido"/>
                        <h:outputText value="#{beanUsuario.usuario.apellidos}" />

                        <h:outputText value="Mail"/>
                        <h:outputText value="#{beanUsuario.usuario.emailUsuario}" />
                    </p:panelGrid>
                </p:outputPanel>
            </p:dialog>
        </h:form>
    </ui:define>
</ui:composition>